<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Discrete Fourier Transform (Spectral) Test - NIST Test Suite</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #9fef00 0%, #c5e063 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            padding: 40px;
        }

        h1 {
            color: #333;
            margin-bottom: 10px;
            font-size: 2.2em;
            border-bottom: 3px solid #9fef00;
            padding-bottom: 15px;
        }

        .test-category {
            display: inline-block;
            background: #9fef00;
            color: #333;
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 600;
            margin-bottom: 20px;
        }

        h2 {
            color: #333;
            margin-top: 30px;
            margin-bottom: 15px;
            font-size: 1.6em;
            border-left: 4px solid #9fef00;
            padding-left: 12px;
        }

        h3 {
            color: #555;
            margin-top: 20px;
            margin-bottom: 10px;
            font-size: 1.2em;
        }

        p {
            color: #666;
            line-height: 1.8;
            margin-bottom: 15px;
            font-size: 1.05em;
        }

        ul {
            margin-left: 25px;
            margin-bottom: 15px;
            color: #666;
            line-height: 1.8;
        }

        li {
            margin-bottom: 8px;
        }

        .highlight-box {
            background: #f8ffe8;
            border-left: 4px solid #9fef00;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
        }

        .info-box {
            background: #e3f2fd;
            border-left: 4px solid #2196F3;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
        }

        .warning-box {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
        }

        .example {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            margin: 15px 0;
            overflow-x: auto;
        }

        .back-link {
            display: inline-block;
            margin-top: 30px;
            padding: 12px 24px;
            background: linear-gradient(135deg, #9fef00 0%, #c5e063 100%);
            color: white;
            text-decoration: none;
            border-radius: 8px;
            font-weight: 600;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .back-link:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(159, 239, 0, 0.4);
        }

        code {
            background: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            color: #d63384;
        }

        .stat-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .stat-card {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
        }

        .stat-label {
            color: #888;
            font-size: 0.9em;
            margin-bottom: 8px;
        }

        .stat-value {
            color: #333;
            font-size: 1.4em;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <span class="test-category">NIST SP 800-22 Statistical Test</span>
        <h1>Discrete Fourier Transform (Spectral) Test</h1>

        <div class="highlight-box">
            <strong>Quick Summary:</strong> The DFT (Spectral) Test detects periodic features in the bit sequence by converting it to the frequency domain using the Discrete Fourier Transform. Truly random sequences should have flat frequency spectra with no dominant periodic components.
        </div>

        <h2>What It Tests For</h2>
        <p>This test identifies repetitive patterns and periodicities that might not be obvious in the time domain. It specifically detects:</p>
        <ul>
            <li><strong>Periodic patterns:</strong> Repeating sequences that occur at regular intervals</li>
            <li><strong>Hidden cycles:</strong> Subtle periodicities that escape simpler statistical tests</li>
            <li><strong>Quasi-periodic behavior:</strong> Near-repetitions that indicate generator cycles</li>
            <li><strong>Spectral peaks:</strong> Dominant frequencies that shouldn't exist in random data</li>
        </ul>

        <h2>How It Works</h2>
        <h3>Step 1: Convert Bits to +1/-1 Representation</h3>
        <p>The binary sequence is transformed so that 0 becomes -1 and 1 stays as +1. This centers the data around zero:</p>
        <div class="example">
Binary:     1 0 1 1 0 0 1 0
Converted: +1 -1 +1 +1 -1 -1 +1 -1
        </div>

        <h3>Step 2: Apply Discrete Fourier Transform</h3>
        <p>The DFT converts the time-domain sequence into frequency components. Each frequency component represents how much that particular frequency contributes to the overall signal:</p>
        <div class="example">
DFT: X[k] = Sum(x[n] * e^(-2πikn/N)) for k = 0 to N/2-1

Where:
  N = sequence length
  k = frequency index
  x[n] = sequence values (+1/-1)
        </div>
        <p>For truly random data, all frequencies should contribute roughly equally (white noise spectrum).</p>

        <h3>Step 3: Calculate Peak Heights</h3>
        <p>The test examines the magnitude (absolute value) of each frequency component. For the first N/2 frequencies:</p>
        <div class="example">
M[k] = |X[k]| = magnitude at frequency k
        </div>
        <p>In a random sequence, these magnitudes should be relatively uniform with no outliers.</p>

        <h3>Step 4: Count Peaks Above Threshold</h3>
        <p>The test counts how many peaks exceed a theoretical threshold:</p>
        <div class="example">
Threshold T = sqrt(3 * N)
Count peaks where M[k] > T
        </div>
        <p>For truly random data, approximately 95% of peaks should fall below this threshold.</p>

        <h3>Step 5: Statistical Comparison</h3>
        <p>The observed percentage of peaks below the threshold is compared to the expected 95%:</p>
        <div class="example">
N0 = number of peaks below threshold
N1 = (95% of N/2) - expected count below threshold
d = (N0 - N1) / sqrt(N * 0.95 * 0.05 / 4)
p-value = erfc(|d| / sqrt(2))
        </div>

        <div class="info-box">
            <strong>Understanding P-Values:</strong>
            <ul>
                <li><strong>p >= 0.01:</strong> PASS - Frequency spectrum appears random</li>
                <li><strong>p < 0.01:</strong> FAIL - Significant periodic components detected</li>
            </ul>
        </div>

        <h2>Interpreting Results</h2>

        <h3>Pass (p-value >= 0.01)</h3>
        <p>The frequency spectrum is flat with no dominant periodic components. This indicates:</p>
        <ul>
            <li>No detectable repeating patterns</li>
            <li>Generator doesn't cycle at predictable intervals</li>
            <li>Sequence appears aperiodic in nature</li>
        </ul>

        <h3>Fail (p-value < 0.01)</h3>
        <p>Significant periodic components exist in the sequence. Common causes include:</p>
        <ul>
            <li><strong>Short Generator Period:</strong> RNG cycles before producing enough unique outputs</li>
            <li><strong>Repeating Patterns:</strong> Sequences like "01010101" or "00110011" create strong frequencies</li>
            <li><strong>Block-Based Generation:</strong> Fixed block sizes create artificial periodicities</li>
            <li><strong>Modulo Artifacts:</strong> Using modulo operations that create repeating remainders</li>
            <li><strong>Clock-Based Generators:</strong> Time-seeded RNGs that cycle with system clock</li>
        </ul>

        <div class="warning-box">
            <strong>Note:</strong> This test is particularly sensitive to periodic patterns. Even subtle periodicities that pass other tests may be detected here. It's one of the most powerful tests for finding hidden structure.
        </div>

        <h2>Common Failure Patterns</h2>

        <h3>Example 1: Simple Repetition</h3>
        <div class="example">
Sequence: 01010101 01010101 01010101 01010101
Analysis: Strong peak at frequency corresponding to period=2
Result:   FAIL - Obvious periodic pattern
Cause:    Alternating bit generation or XOR with constant
        </div>

        <h3>Example 2: Block Pattern</h3>
        <div class="example">
Sequence: 11110000 11110000 11110000 11110000
Analysis: Peak at frequency for period=8
Result:   FAIL - Block-based periodicity
Cause:    Byte-wise generation with repeating bytes
        </div>

        <h3>Example 3: Short PRNG Cycle</h3>
        <div class="example">
Generator: LCG with modulus 256, repeated in sequence
Analysis:  Peaks at frequencies corresponding to 256-bit cycle
Result:    FAIL - Generator period detected
Cause:     Insufficient state space in generator
        </div>

        <h3>Example 4: Near-Periodic Pattern</h3>
        <div class="example">
Sequence: Slightly varying repetitions every ~100 bits
Analysis: Peak at low frequency range
Result:   FAIL - Quasi-periodic behavior
Cause:    Generator state correlation over time
        </div>

        <h2>Technical Details</h2>
        <div class="stat-grid">
            <div class="stat-card">
                <div class="stat-label">Test Type</div>
                <div class="stat-value">Spectral</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Min Bits</div>
                <div class="stat-value">1,000</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Threshold</div>
                <div class="stat-value">95%</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Significance</div>
                <div class="stat-value">α = 0.01</div>
            </div>
        </div>

        <h2>When to Use This Test</h2>
        <p>This test is essential for:</p>
        <ul>
            <li><strong>Cryptographic RNGs:</strong> Detecting periodicities that could leak information about generator state</li>
            <li><strong>PRNG Validation:</strong> Ensuring the generator period is sufficiently long</li>
            <li><strong>Hardware RNGs:</strong> Finding oscillator-based artifacts or clock-synchronized patterns</li>
            <li><strong>Stream Ciphers:</strong> Verifying that keystream output has no periodic structure</li>
            <li><strong>Time-Based Seeds:</strong> Detecting patterns from clock-based initialization</li>
        </ul>
        <p>This test is particularly effective at catching <strong>linear congruential generators</strong>, <strong>LFSRs</strong>, and other generators with short periods.</p>

        <h2>Mathematical Background</h2>
        <p>The Discrete Fourier Transform decomposes a signal into its constituent frequencies. For a truly random bit sequence converted to ±1 values, the DFT should produce a spectrum resembling white noise - equal power at all frequencies. Any deviation from flatness indicates structure in the data. The test uses the fact that for random sequences, peak magnitudes follow a Rayleigh distribution, allowing statistical hypothesis testing.</p>

        <h2>References</h2>
        <ul>
            <li>NIST Special Publication 800-22 Rev. 1a</li>
            <li>Section 2.6: Discrete Fourier Transform (Spectral) Test</li>
            <li><a href="https://csrc.nist.gov/publications/detail/sp/800-22/rev-1a/final" target="_blank">Full NIST Documentation</a></li>
        </ul>

        <a href="/" class="back-link">← Back to Validator</a>
    </div>
</body>
</html>
